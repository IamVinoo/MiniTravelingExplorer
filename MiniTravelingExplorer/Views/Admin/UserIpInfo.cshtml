@using MiniTravelingExplorer.Models
@using MiniTravelingExplorer.Utils
@using Newtonsoft.Json;

@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

@Html.Partial("_AdminHeader")

@Html.Partial("_AdminSidebar")

@{
    List<UserIpInfo> userIpInfoList = ViewData[Constant.USER_IP_INFO_TABLE] as List<UserIpInfo>;
    bool isUserIpInfoEmpty = userIpInfoList == null || !userIpInfoList.Any();
}

<main id="main" class="main">
    <div class="pagetitle">
        <h1 class="text-primary"><strong>User IP Info</strong></h1>
    </div>

    <section class="section">
        <div class="row">
            <div class="row">
                <div class="col-md-12">
                    @Html.Partial("_ResponsiveMessage")
                </div>

                <div class="col-md-12 user-ip-info-list-container">
                    @if (!isUserIpInfoEmpty)
                    {
                        <table id="user_ip_info_list_container" class="display cell-border hover order-column row-border stripe data-table-container"></table>
                        <script type="text/javascript">
                            var userIpInfoListInterval = setInterval(function () {
                                var isLoaded;
                                try {
                                    initUserIpInfoListPage(@Html.Raw(JsonConvert.SerializeObject(userIpInfoList)));
                                    isLoaded = true;
                                }
                                catch (err) {
                                    isLoaded = false;
                                }
                                finally {
                                    if (isLoaded) {
                                        clearInterval(userIpInfoListInterval);
                                    }
                                }
                            }, 100);
                        </script>
                    }
                </div>
            </div>
        </div>
    </section>
</main>

@Html.Partial("_AdminFooter")